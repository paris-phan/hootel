{% extends base_template %}

{% block title %}Book Hotel - HotelManager6000{% endblock %}

{% block content %}
{% load static %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
  body {
    background-color: #f5f7fa;
    font-family: 'Segoe UI', sans-serif;
  }

  .card.hotel-info {
    border: none;
    border-radius: 16px;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
    overflow: hidden;
  }

  .card.hotel-info .card-header {
    font-size: 1.6rem;
    font-weight: 600;
  }

  .card.hotel-info img {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  .card.booking-form {
    border: none;
    border-radius: 16px;
    margin-top: 2rem;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
  }

  .card.booking-form .card-header {
    font-size: 1.4rem;
    font-weight: 600;
  }

  .form-control {
    border-radius: 0.5rem;
  }

  .btn {
    border-radius: 50px;
    font-weight: 500;
    padding: 0.5rem 1.5rem;
  }

  .btn-primary {
    background-color: #1e88e5;
    border: none;
  }

  .btn-secondary {
    background-color: #6c757d;
    border: none;
  }

  .btn:hover {
    opacity: 0.9;
  }
</style>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      
      <!-- Hotel Info -->
      <div class="card hotel-info">
        <div class="card-header bg-primary text-white">
          <h2 class="mb-0">{{ hotel.name }}</h2>
        </div>
        <div class="row g-0">
          <div class="col-md-6">
            <img src="{{ hotel.image_url }}" alt="{{ hotel.name }}" class="img-fluid" style="width: 100%; height: 100%; object-fit: cover;">
          </div>
          <div class="col-md-6 d-flex align-items-center">
            <div class="card-body">
              <h5 class="card-title"><i class="bi bi-geo-alt-fill text-primary"></i> {{ hotel.location }}</h5>
              <p class="card-text">{{ hotel.description }}</p>
              <p class="text-muted"><i class="bi bi-calendar-check"></i> Available for booking</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Booking Form -->
      <div class="card booking-form">
        <div class="card-header bg-dark text-white">
          Book Your Stay
        </div>
        <div class="card-body">
          <form method="post">
            {% csrf_token %}
            <div class="mb-3">
              <label for="check_in" class="form-label">Check-in Date</label>
              <input type="date" id="check_in" name="check_in" class="form-control" required>
            </div>
            <div class="mb-3">
              <label for="check_out" class="form-label">Check-out Date</label>
              <input type="date" id="check_out" name="check_out" class="form-control" required>
            </div>
            <div class="d-flex justify-content-between mt-4">
              <button type="submit" class="btn btn-primary">Book Now</button>
              <a href="{% url 'patron:search' %}" class="btn btn-secondary">Cancel</a>
            </div>
          </form>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);

    const checkIn = document.getElementById('check_in');
    const checkOut = document.getElementById('check_out');

    const formatDate = (date) => {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    };

    checkIn.min = formatDate(today);
    checkOut.min = formatDate(tomorrow);

    checkIn.addEventListener('change', function () {
        const selectedDate = new Date(this.value);
        const nextDay = new Date(selectedDate);
        nextDay.setDate(nextDay.getDate() + 1);

        checkOut.min = formatDate(nextDay);

        if (new Date(checkOut.value) <= selectedDate) {
            checkOut.value = formatDate(nextDay);
        }
    });
});
</script>
{% endblock %}
